% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cna_plot.R
\name{CNAPlot_Highlight}
\alias{CNAPlot_Highlight}
\title{CNA Plot with Gene Highlighting}
\usage{
CNAPlot_Highlight(
  depth_bigwig_file,
  variant_file,
  txdb,
  org,
  gene_delta_threshold = 2,
  downsample = 0.1,
  point_size = 0.01,
  line_size = 0.1,
  line_color = "red",
  colors = NULL,
  max_value = NULL,
  min_value = NULL,
  min_variant_distance = 10000,
  method = c("fit", "delta", "loess"),
  trend_window = 50,
  apply_weight = TRUE,
  outside_weight = 0.25,
  inside_weight = 1,
  variant_alpha = 0.1,
  nudge_y = 3,
  samplename = "",
  chr_filter = NULL,
  exclude_xy = FALSE,
  highlight_genes = NULL,
  gband_file = file.path("~/develop/pacbiowdlR/cytobands.tsv"),
  gband_y_offset = -0.2,
  gband_text_size = 2,
  showCNAbands = FALSE,
  return_data = FALSE
)
}
\arguments{
\item{depth_bigwig_file}{Character. File path to a BigWig file containing coverage depth data.}

\item{variant_file}{Character. File path to a VCF file with variant data.}

\item{txdb}{A transcript database object used for gene annotation.}

\item{gene_delta_threshold}{Numeric. Delta threshold for gene annotation filtering.}

\item{downsample}{Numeric. Proportion of the coverage data to retain after downsampling.}

\item{point_size}{Numeric. Size of individual points in the plot.}

\item{line_size}{Numeric. Size of the trend line.}

\item{colors}{Named vector of colors for chromosomes; if \code{NULL}, defaults to alternating black and gray.}

\item{max_value}{Numeric. Maximum allowed delta value; values above are capped.}

\item{min_value}{Numeric. Minimum allowed delta value; values below are capped.}

\item{min_variant_distance}{Numeric. Minimum variant length (in bp) to include.}

\item{method}{Character. One of \code{"fit"}, \code{"delta"}, or \code{"loess"} determining the method used to compute delta values.}

\item{trend_window}{Integer. Window size for computing the running median trend line.}

\item{apply_weight}{Logical. If \code{TRUE}, applies a weight multiplier to delta values outside CNA calls.}

\item{outside_weight}{Numeric. Weight multiplier applied to delta values outside CNA calls.}

\item{inside_weight}{Numeric. Weight multiplier for delta values inside CNA calls.}

\item{variant_alpha}{Numeric. Transparency level for variant call rectangles.}

\item{nudge_y}{Numeric. Vertical nudge for positioning gene labels.}

\item{samplename}{Character. Sample label used in the plot title.}

\item{chr_filter}{Character. If provided, restricts the analysis to the specified chromosome.}

\item{exclude_xy}{Logical. If \code{TRUE}, chromosomes X and Y are excluded.}

\item{highlight_genes}{Character vector. Specific gene symbols to highlight in the plot.}

\item{gband_file}{Character. File path to a cytogenetic band data file (e.g., a TSV file).}

\item{gband_y_offset}{Numeric. Vertical offset for G-band label placement.}

\item{gband_text_size}{Numeric. Text size for G-band labels.}

\item{showCNAbands}{Logical. If \code{TRUE}, displays G-band annotations on the plot.}

\item{return_data}{Logical. If \code{TRUE}, returns a list containing the plot, coverage data, variant calls, and gene annotations.}
}
\value{
Either a \code{ggplot2} object representing the CNA plot with gene highlights or a list with additional data if \code{return_data} is \code{TRUE}.
}
\description{
Generates a genome-wide CNA plot with additional gene annotation and labeling.
This function extends \code{CNAPlot} by annotating gene coordinates (using \code{annotateCoverageWithGenes()})
and optionally highlighting selected genes and cytogenetic (G-band) features.
}
\details{
The function executes the following steps:
\enumerate{
  \item Imports and filters coverage data.
  \item Downsamples the data and computes delta values using the specified method.
  \item Imports VCF variant calls, filtering based on chromosome and minimum variant distance.
  \item Computes genomic offsets (via \code{generate_offsets()}) and marks variant regions.
  \item Applies weight multipliers and computes a running median trend line using \code{rollapply()}.
  \item Annotates coverage with gene information using \code{annotateCoverageWithGenes()}.
  \item Constructs the plot with additional gene points and labels, and if specified, annotates cytogenetic bands.
}
}
