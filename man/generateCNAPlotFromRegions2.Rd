% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{generateCNAPlotFromRegions2}
\alias{generateCNAPlotFromRegions2}
\title{Generate CNA Plot from Regions}
\usage{
generateCNAPlotFromRegions2(
  depth_bigwig_file,
  variant_file,
  threshold = 1.5,
  downsample = 0.01,
  point_size = 0.5,
  colors = NULL,
  log_scale = TRUE,
  remove_centromeres = TRUE,
  max_value = NULL,
  min_value = NULL,
  min_variant_distance = 10000,
  samplename = "",
  show_cytobands = FALSE,
  cytoband_angle = 90,
  chr_filter = NULL,
  return_data = FALSE
)
}
\arguments{
\item{depth_bigwig_file}{Character. File path to a BigWig file containing coverage (depth) information.}

\item{variant_file}{Character. File path to a VCF file containing variant call information.}

\item{threshold}{Numeric. Delta threshold used for display. Default is 1.5.}

\item{downsample}{Numeric. Proportion of the coverage data to retain after downsampling. Default is 0.01.}

\item{point_size}{Numeric. Size of the points in the plot. Default is 0.5.}

\item{colors}{Named vector. Colors to be used for chromosomes; if \code{NULL}, default colors are assigned.}

\item{log_scale}{Logical. If \code{TRUE}, applies a log scale (unused in code, but available for future extension). Default is \code{TRUE}.}

\item{remove_centromeres}{Logical. If \code{TRUE}, centromere regions are removed (unused in code, but available for extension). Default is \code{TRUE}.}

\item{max_value}{Numeric. Maximum delta value for setting plot y-axis limits. Default is \code{NULL}.}

\item{min_value}{Numeric. Minimum delta value for setting plot y-axis limits. Default is \code{NULL}.}

\item{min_variant_distance}{Numeric. Minimum distance (in bp) for a variant call to be retained. Default is 10000.}

\item{samplename}{Character. A label for the sample which is displayed in the plot title.}

\item{show_cytobands}{Logical. If \code{TRUE}, cytoband labels are added to the variant calls. Default is \code{FALSE}.}

\item{cytoband_angle}{Numeric. Angle (in degrees) to rotate the cytoband text labels. Default is 90.}

\item{chr_filter}{Character. If provided, limits the analysis to the specified chromosome.}

\item{return_data}{Logical. If \code{TRUE}, returns a list containing the plot along with the underlying
coverage and variant call data. Default is \code{FALSE}.}
}
\value{
Either a \code{ggplot2} object representing the CNA plot, or, if \code{return_data} is \code{TRUE},
  a list with elements \code{plot}, \code{coverage_data}, and \code{variant_calls}.
}
\description{
Generates a genome-wide copy number alteration (CNA) plot by combining coverage data from a BigWig
file and variant calls from a VCF file. Delta values are computed from the coverage data and overlaid
with variant regions. Optionally, cytoband annotations can be added.
}
\details{
This function performs the following steps:
  \enumerate{
    \item Imports coverage data from a BigWig file using \code{import.bw()} from \code{rtracklayer}
          and converts it into a data frame.
    \item Filters for valid chromosomes (chr1-22, X, Y), optionally restricting to a single chromosome.
    \item Downsamples the coverage data and computes a delta value for each data point.
    \item Reads variant calls from a VCF file using \code{fread()} from \code{data.table}, parsing out
          the end positions and variant types.
    \item Optionally annotates cytoband information for each variant call using overlaps with
          \code{hg19IdeogramCyto} (assumed to be available in the global environment).
    \item Filters variant calls by a minimum distance if specified.
    \item Computes cumulative genomic offsets via the \code{generate_offsets()} function.
    \item Constructs and returns a plot built with \code{ggplot2} that shows the coverage data points,
          highlighted variant regions, and optionally cytoband labels.
  }
}
\keyword{internal}
